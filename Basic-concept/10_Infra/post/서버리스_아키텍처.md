# **[Infra] 서버리스 아키텍처**

2023년 08월 25일

<br>

## **1. 서버리스 아키텍처**

서버리스(Serverless)를 직역하면 `서버가 없다`라는 의미이다. 하지만 사실상 서버가 없다는 것이 아니다. 개발자가 서버를 직접 관리할 필요가 없는 아키텍처를 말한다.

서버리스의 대표적이 기술로는 `BaaS(Backend as a Service)` 혹은 `FaaS(Function as a Service)`가 있다. BaaS를 제공하는 서비스 중에선, Firebase, Parse, Kinvey 등이 있고, FaaS를 제공하는 서비스 중에선, AWS Lambda, Azure Functions, Google Cloud Functions 등이 있다.

<br>
<br>

## **2. 기존 서비스 모델**

<br>

### **2-1. 자체적 시스템 설계 (PaaS, Packaged Software)**

시스템에서 필요한 모든 인프라를 직접 관리하는 것을 의미한다. 공간, 하드웨어, 네트워크, 운영체제 등 모두 직접 관리하는 것이다. 단점은 시간과 비용 소모가 크다.

<br>

### **2-2. 클라우드 서비스 모델**

<br>

#### **2-1. 서비스형 인프라 (IaaS, Infrastructure as a Service)**

서버, 스토리지, 네트워킹 및 가상화된 컴퓨팅 인프라를 제공한다. 해당 서비스 모델을 제공받는 클라이언트는 서버자원, 네트워크, 전력 등의 인프라를 직접 구축할 필요 없이 관리자 패널에서 인프라를 구성하고 사용하면 된다. 가상머신을 만들고, 네트워크를 설정하고, 하드웨어도 설정하고, 거기에 운영체제를 설치해서 애플리케이션을 구동 할 수 있고 사용량을 쉽게 모니터링 할 수 있다. 또한 트래픽이 증가하거나 감소함에 따라 유연한 방식으로 컴퓨팅 리소스를 운영할 수 있다. IaaS의 예시로는 AWS, Microsoft Azure 등이 있다.

<br>

#### **2-2. 플랫폼을 통한 서비스 (PaaS, Platform as a Service)**

IaaS 에서 한번 더 추상화된 모델이라고 생각하면 된다. 네트워크, 그리고 런타임까지 제공된다. 해당 서비스 모델을 제공받는 클라이언트는 응용 프로그램을 구축하는 데에만 집중할 수 있고 애플리케이션만 배포하면 바로 구동시킬 수 있게 된다. PaaS의 예시로는 Hiroku, AWS Elastic Beanstalk, Azure App Services 등이 있다. 이를 사용하면 Auto Scaling 및 Load Balancing 도 손쉽게 적용 할 수 있다.

> **- 오토 스케일링(Auto Scaling)**: 통신 데이터 양에 따른 부하에 따라 자동으로 가상 서버의 대수를 증감시키는 기능
>
> **- 로드 밸런싱(Load Balancing)**: 통신 데이터를 나눠 여러 가상 서버에 전달하여 분산 처리하는 기술

<br>

#### **2-3. 서비스형 소프트웨어 (SaaS, Software as a Service)**

공급업체가 모든 물리적 및 가상 핵심 인프라, 미들웨어, 데이터베이스 관리 시스템, 개발 툴 등을 제공하고 호스팅한다. 여기에 추가로 `데이터`와 `응용 프로그램`이 포함된다. 즉, 특정 앱 또는 웹 포털을 통해 액세스하는 서비스로, 클라이언트 조직의 최종 사용자에게 제공되는 완전한 소프트웨어 솔루션을 말한다. 사용자는 별도의 설치없이 인터넷 연결만 가능하다면 해당 소프트웨어를 즉시 사용할 수 있다. SaaS의 예시로는 웹 메일, 구글 클라우드, 아이 클라우드, 드롭박스 등이 있다.

<br>
<br>

## **3. 서버리스 컴퓨팅 서비스, BaaS와 FaaS**

<br>

### **3-1. BaaS (Backend as a Service)**

웹 애플리케이션을 만들 때 백엔드 서버개발은 필수적인데 서버 개발을 하다보면 서버의 확장, 보안성 등을 고려해야한다. 그래서 탄생한 서비스가 `BaaS(Backend as a Service)`이다. BaaS는 단어 그대로 백엔드 관리자 영역을 모듈화하여 서비스로 제공한다는 개념인데 앱 개발에 있어서 필요한 기능들(데이터베이스, 소셜서비스 연동, 파일시스템 등)을 API로 제공해준다. 이 기능들을 제공해줌으로서 개발자들이 서버 개발을 하지 않고도 필요한 기능을 쉽고 빠르게 구현할 수 있고 사용한 만큼 비용을 지불한다. 또한 해당 서비스의 사용자가 급증하여도 서버가 자동으로 확장된다. BaaS의 가장 큰 장점은 서버 확장 작업이 불필요하기 때문에 개발 시간의 단축 및 인건비 절감의 장점이 있다. 대표적인 BaaS의 예시로는 Auth0, AWS Cognito, Firebase 등이 있다.

<br>

### **3-2. FaaS (Function as a Service)**

코드, 즉 함수를 서비스로 제공한다. 애플리케이션 개발에서 서버를 프로비저닝하거나 관리하지 않고도 코드를 실행할 수 있도록 해주는 컴퓨팅 서비스이다. 함수를 실행하기 위해 서버를 올리고 런타임을 구성하고 코드를 배포해서 실행해야 하는 일련의 과정을 없애고, 원하는 로직을 함수로 등록해놓고 각 클라우드 서비스 제공사의 조건만 충족하면 특정 이벤트가 발생했을 때 함수가 호출된다. 함수가 호출되면 컨테이너나 가상머신(VM)이 실행되며 정의한 함수가 런타임 내에서 실행된 다음 작업을 마치면(혹은 최대 타임아웃 시간이 지나면) 종료된다. 그리고 이 함수들이 실행되는 횟수, 시간에 비례하여 비용을 지불하게 된다.

> 특정 이벤트가 발생했을 때 서버리스 함수가 실행된다고 하였는데 여기서 말하는 특정 이벤트를 예시로 들면 주기적인 시간, 혹은 특정 URL 접근 등 사용자가 지정한 특정 이벤트를 말한다. 이 특정 이벤트가 실행될 때, 즉 필요한 상황에서만 서버리스 함수가 호출되기 때문에 비용 절감의 장점을 가진다.

서버 시스템에 대해서 신경쓰지 않아도 된다는 점이 PaaS와 유사하기도 한데 가장 중요한 차이점은 PaaS의 경우 전체 애플리케이션을 배포하며 일단 어떠한 서버에서 당신의 애플리케이션이 24시간동안 계속 돌아가고 있다는 점이다.

반면 FaaS 는 애플리케이션이 아닌 함수를 배포하며, 계속 실행되고 있는 것이 아닌, 특정 이벤트가 발생 했을 때 실행되며, 실행이 되었다가 작업을 마치면 (혹은 최대 타임아웃 시간을 지나면) 종료된다.

FaaS는 백엔드 구현, 크롤링, 이미지 업로드 시 리사이징, AWS Cloudwatch 및 CloudTrail과의 연동을 통한 로그 분석 및 실시간 모니터링, 기타 자동화 작업 등 다양한 방식으로 활용이 가능하다. 넷플릭스의 경우 동영상 인코딩, 검증, 태깅, 공개, 백업 등의 작업들을 `AWS Lambda`를 통해 자동화 시켰다.

> AWS Lambda는 AWS에서 제공하는 FaaS 서비스이다.

내가 다니던 이전 직장에서 운영하던 서비스에서도 사용자가 프로필 이미지를 업로드할 때 이 업로드 된 이미지를 리사이징하기 위해 `AWS Lambda`를 활용했었다.

하지만 FaaS 사용 시 함수에서 사용 가능한 자원에 제한(AWS에서는 최대 1500MB 메모리 사용, 최대 300초의 처리 시간), 콜드 스타트(호출 시 함수가 구동되는데 시간이 걸림), 로컬 데이터 사용 불가능(함수들은 무상태적이므로 로컬 스토리지 사용 불가 및 변수와 데이터 공유 불가능)하다는 특징을 고려하며 사용해야한다.

<br>
<br>

## **4. 레퍼런스**

- https://velopert.com/3546
- https://velopert.com/3543
- https://www.freshworks.com/ko/freshdesk/kblogs/iaas-paas-saas/
- https://elice.io/newsroom/saas_paas_iaas
- [https://inpa.tistory.com/entry/WEB-🌐-서버리스ServerLess-개념-💯-총정리-BaaS-FaaS](https://inpa.tistory.com/entry/WEB-%F0%9F%8C%90-%EC%84%9C%EB%B2%84%EB%A6%AC%EC%8A%A4ServerLess-%EA%B0%9C%EB%85%90-%F0%9F%92%AF-%EC%B4%9D%EC%A0%95%EB%A6%AC-BaaS-FaaS)
